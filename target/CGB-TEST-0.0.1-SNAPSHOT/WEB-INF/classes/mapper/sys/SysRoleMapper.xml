<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.db.sys.dao.SysRoleDao">
    <!--查询数据 -->
    <select id="findPageObjects" resultType="com.db.sys.entity.SysRole">
        select * from jtsys.sys_roles
        <include refid="queryWhereId"/>
        order by createdTime desc
        limit #{startIndex},#{pageSize}
    </select>
    <!--统计个数 -->
    <select id="getRowCount" resultType="int">
        select  count(*) from jtsys.sys_roles
        <include refid="queryWhereId"/>
    </select>
    <!-- 根据id 删除数据 -->
    <delete id="deleteObject" parameterType="int">
        delete from jtsys.sys_roles
        where id in(#{id})
    </delete>
    <!--
     1) useGeneratedKeys 表示要使用自增长的主键值
     2) keyProperty 将自增长主键值赋值给keyProperty
               指向的参数属性
    -->
    <insert id="insertObject"
            parameterType="com.db.sys.entity.SysRole"
            useGeneratedKeys="true"
            keyProperty="id">
        insert into jtsys.sys_roles(id,name,
   note,createdTime,modifiedTime,createdUser,modifiedUser)
            values (null,#{name},#{note},now(),now(),
                    #{createdUser},#{modifiedUser})
    </insert>

    <resultMap type="com.db.sys.vo.SysRoleMenuVo"
               id="sysRoleMenuVo">
      <!-- one2many -->
      <collection property="menuIds"
      column="roleId"
      select="com.db.sys.dao.SysRoleMenuDao
      .findMenuIdsByRoleId">
      </collection>
  </resultMap>

    <select id="findObjectById" resultType="com.db.sys.entity.SysRole">
        select id,name,note from jtsys.sys_roles
        where id=#{id}
    </select>
    

<sql id="queryWhereId">
    <where>
        <if test="name!=null and name!=''">
            name like concat("%",#{name},"%")
        </if>
    </where>
</sql>
    


</mapper>








